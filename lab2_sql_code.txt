----lab2 SQL----

--create database study
--GO
--use study  
--GO

--1
create table Student(
Sno  char(10) primary key,
Sname nvarchar(10),
Ssex nchar(1) check(Ssex in('男','女')),
birthday date,
class nvarchar(10),
)

--4
create table Teacher(
tno char(10) primary key,
name nvarchar(10),
sex nchar(1) check(sex in('男','女')),
prof nvarchar(15),
depart nvarchar(15) NULL,
salary float,
constraint ck_sly check((prof='教授' and salary>10000) or (prof='副教授' and salary>8000) and salary>0)
)

--2
create table Course(
Cno char(10) primary key,
Cname nvarchar(10),
Cpno char(10),
Ccredit float default 0,
tno char(10) foreign key references Teacher(tno)
)

--3
create table Score(
Sno char(10) foreign key references Student(Sno),
Cno char(10) foreign key references Course(Cno),
Grade int,
primary key(Sno,Cno),check(Grade>=0 and Grade<=100 or Grade is NULL) 
)

--5
alter table Course add 开设学期 char(20)
GO
alter table Score add 考试状态  nvarchar(5) check(考试状态 in('正常','旷考','缓考','无资格') ) default NULL
GO
alter table Score add constraint ck_Grade check((考试状态='正常' and Grade>0) or (考试状态='旷考' and Grade=0) or ((考试状态='缓考'or 考试状态='无资格')and Grade is NULL))

--6
alter table Teacher drop constraint ck_sly

--7

--8
select distinct salary from Teacher

--9
select distinct class from Student

--10
select Course.开设学期,Teacher.name from Course,Teacher
where Course.Cname='xxxxx' and Course.Cno=Teacher.Cno

--11
select Course.name,Score.Grade,Teacher.name from Teacher,Course,Score
where Score.Sno='xxxxx' and Score.Cno=Course.Cno and Course.tno=Teacher.tno

--12  
select Student.Sname from Student,Score
where Cno='xxxxx' and Student.Sno=Score.Sno and (Score.Grade is NULL or Score.Grade<60)

--13
select Student.Sname from Student,Score
where Score.Cno='xxxxx' and Student.Ssex='男' and substring(Student.Sname,1,1)='张'

--14
select Student.Sname from Student,Score
where Score.Cno='xxxxx' and Score.Grade>0

--15
select 
